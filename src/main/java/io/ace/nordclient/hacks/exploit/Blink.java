package io.ace.nordclient.hacks.exploit;

import io.ace.nordclient.event.PacketEvent;
import io.ace.nordclient.hacks.Hack;
import net.minecraft.network.play.client.CPacketPlayer;
import team.stiff.pomelo.impl.annotated.handler.annotation.Listener;

import java.util.LinkedList;
import java.util.Queue;

public class Blink extends Hack {

    public Blink() {
        super("Blink", Category.EXPLOIT, 4490307);
    }
    int delay = 0;

    Queue<CPacketPlayer> packets = new LinkedList<>();

    @Listener
    public void onUpdate(PacketEvent.Send event) {
            if (event.getPacket() instanceof CPacketPlayer) {
                //if (delay <= 20) {
                    event.setCanceled(true);
                    packets.add((CPacketPlayer) event.getPacket());
            //}
        }
    }

    @Override
    public void onDisable() {
        while (!packets.isEmpty()) {
            mc.player.connection.sendPacket(packets.poll());
        }
    }

    @Override
    public void onUpdate() {
        delay++;
        if (delay > 20) {
            while (!packets.isEmpty()) {
                mc.player.connection.sendPacket(packets.poll());
                packets.clear();
                delay = 0;
            }
        }
    }
}
