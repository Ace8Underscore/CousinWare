package io.ace.nordclient.hacks.exploit;

import io.ace.nordclient.event.EventPlayerDamageBlock;
import io.ace.nordclient.hacks.Hack;
import io.ace.nordclient.utilz.InventoryUtil;
import net.minecraft.init.Items;
import net.minecraft.item.ItemPickaxe;
import net.minecraft.network.play.client.CPacketHeldItemChange;
import net.minecraft.network.play.client.CPacketPlayerDigging;
import team.stiff.pomelo.impl.annotated.handler.annotation.Listener;

public class SecretMine extends Hack {

    public SecretMine() {
        super("SecretMine", Category.EXPLOIT, 11993911);
    }

    @Listener
    public void damageBlock(EventPlayerDamageBlock event) {
        if (mc.playerController.isHittingBlock && !(mc.player.getHeldItemMainhand().getItem() instanceof ItemPickaxe)) {
            if (InventoryUtil.findItemInHotbar(Items.DIAMOND_PICKAXE) != -1) {
                mc.player.connection.sendPacket(new CPacketHeldItemChange(InventoryUtil.findItemInHotbar(Items.DIAMOND_PICKAXE)));
                mc.player.connection.sendPacket(new CPacketPlayerDigging(CPacketPlayerDigging.Action.START_DESTROY_BLOCK, event.getPos(), event.getDirection()));
                mc.player.connection.sendPacket(new CPacketPlayerDigging(CPacketPlayerDigging.Action.STOP_DESTROY_BLOCK, event.getPos(), event.getDirection()));
                mc.player.connection.sendPacket(new CPacketHeldItemChange(mc.player.inventory.currentItem));
            }
        }
    }
}
